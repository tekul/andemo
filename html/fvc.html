<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style type="text/css">

body {
  font: 10px sans-serif;
  text-rendering: optimizelegibility;
}

.arc path {
    stroke: #fff;
}
</style>
</head>
<body>

<p id="pie">

<script src="d3.v3.min.js"></script>
<script src="fvc.js"></script>
<script>
  var xdUrl="http://localhost:8080/metrics/field-value-counters/lang";

  var chart = fvcPieChart()
   .x(function(d) { return d.key; })
   .y(function(d) { return +d.value; })
   .width(960)
   .height(500);

  function redraw() {
    d3.json(xdUrl)
    .get(function(error, json) {
      if (error) return console.warn(error);
      var counts = new Array();
      var data = d3.entries(json.counts);
      data.sort(function(a,b) { return a.value - b.value; });
      d3.select("#pie")
          .datum(data)
          .call(chart);
    });
  }
//  redraw.call();
  setInterval(redraw, 1000);

</script>
</body>
</html>
